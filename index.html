<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Jônatas & Érica - 16 BIT</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  touch-action:none;
  user-select:none;
}

body{
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  font-family:'Press Start 2P';
}

#gamebox{
  width:360px;
  height:640px;
  background:#080808;
  border:6px solid #22ff44;
  box-shadow:0 0 25px #22ff44;
  position:relative;
}

canvas{
  width:100%;
  height:100%;
  image-rendering:pixelated;
  background:#020617;
}

#start{
  position:absolute;
  inset:0;
  background:radial-gradient(circle,#000,#020617);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  color:#22ff44;
  z-index:10;
}

#start h1{
  font-size:16px;
  text-align:center;
  animation:pulse 1s infinite alternate;
}

#start button{
  margin-top:20px;
  padding:12px 24px;
  background:#22ff44;
  border:4px solid #0f0;
  font-family:'Press Start 2P';
  font-size:10px;
}

@keyframes pulse{
  from{opacity:1;}
  to{opacity:0.5;}
}

#hud{
  position:absolute;
  top:6px;
  left:6px;
  font-size:9px;
  color:#fff;
  background:#000a;
  border:2px solid #22ff44;
  padding:4px;
}

#controls{
  position:absolute;
  bottom:8px;
  width:100%;
  display:flex;
  justify-content:space-between;
  padding:0 8px;
}

#move{
  display:grid;
  grid-template-columns:60px 60px 60px;
  grid-template-rows:60px 60px 60px;
  gap:6px;
}

#actions{
  display:flex;
  flex-direction:column;
  gap:14px;
}

.btn{
  width:60px;
  height:60px;
  border-radius:10px;
  background:linear-gradient(#444,#111);
  border:3px solid #22ff44;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:20px;
  color:#22ff44;
  box-shadow:0 0 10px #22ff44;
}
</style>
</head>

<body>

<div id="gamebox">

<div id="start">
  <h1>JÔNATAS<br>&<br>ÉRICA</h1>
  <button id="startBtn">START</button>
</div>

<div id="hud">
HP: <span id="life">100</span><br>
LV: <span id="level">1</span><br>
PTS: <span id="score">0</span>
</div>

<canvas id="game" width="1080" height="1920"></canvas>

<div id="controls">
  <div id="move">
    <div></div>
    <div class="btn" id="up">▲</div>
    <div></div>
    <div class="btn" id="left">◀</div>
    <div></div>
    <div class="btn" id="right">▶</div>
    <div></div>
    <div class="btn" id="down">▼</div>
    <div></div>
  </div>

  <div id="actions">
    <div class="btn" id="rotate">↻</div>
    <div class="btn" id="shoot">⚡</div>
  </div>
</div>

</div>

<audio id="bgm" loop src="https://files.freemusicarchive.org/storage-freemusicarchive-org/music/no_curator/Rolemusic/arcade/Rolemusic_-_04_-_Enigmatic_Power.mp3"></audio>
<audio id="startSound" src="https://assets.mixkit.co/sfx/preview/mixkit-game-start-610.mp3"></audio>
<audio id="shootSound" src="https://assets.mixkit.co/sfx/preview/mixkit-laser-shoot-1674.mp3"></audio>
<audio id="loseVoice" src="https://translate.google.com/translate_tts?ie=UTF-8&tl=pt-BR&client=tw-ob&q=Tente+novamente"></audio>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let move={up:false,down:false,left:false,right:false};
let life=100,level=1,score=0;
let angle=0;

const player={x:540,y:960,size:44,speed:7};
let enemies=[],shots=[],princess={};

function bind(id,dir){
  const el=document.getElementById(id);
  el.addEventListener("touchstart",e=>{e.preventDefault();move[dir]=true;});
  el.addEventListener("touchend",e=>{e.preventDefault();move[dir]=false;});
}

["up","down","left","right"].forEach(d=>bind(d,d));

document.getElementById("rotate").addEventListener("touchstart",e=>{e.preventDefault();angle+=0.35;});
document.getElementById("shoot").addEventListener("touchstart",e=>{e.preventDefault();shoot();});

document.getElementById("startBtn").onclick=()=>{
  document.getElementById("start").style.display="none";
  document.getElementById("startSound").play();
  const bgm=document.getElementById("bgm");
  bgm.volume=0.35;
  bgm.play();
  newLevel();
  loop();
};

function shoot(){
  document.getElementById("shootSound").play();
  shots.push({
    x:player.x+player.size/2,
    y:player.y+player.size/2,
    dx:Math.cos(angle)*16,
    dy:Math.sin(angle)*16,
    size:10
  });
}

function newLevel(){
  enemies=[];
  shots=[];
  for(let i=0;i<level*4;i++){
    enemies.push({
      x:Math.random()*1000+40,
      y:Math.random()*1800+40,
      size:36,
      speed:1.5+level*0.3
    });
  }
  princess={x:Math.random()*900+100,y:Math.random()*1700+100,size:24};
  document.getElementById("level").innerText=level;
}

function update(){
  if(move.up)player.y-=player.speed;
  if(move.down)player.y+=player.speed;
  if(move.left)player.x-=player.speed;
  if(move.right)player.x+=player.speed;
}

function draw(){
  ctx.fillStyle="#020617";
  ctx.fillRect(0,0,1080,1920);

  ctx.save();
  ctx.translate(player.x+22,player.y+22);
  ctx.rotate(angle);
  ctx.fillStyle="#22ff44";
  ctx.fillRect(-22,-22,44,44);
  ctx.restore();

  enemies.forEach(e=>{
    ctx.fillStyle="#ff3333";
    ctx.fillRect(e.x,e.y,e.size,e.size);
  });

  ctx.fillStyle="#ff66ff";
  ctx.beginPath();
  ctx.arc(princess.x,princess.y,princess.size,0,Math.PI*2);
  ctx.fill();

  shots.forEach(s=>{
    ctx.fillStyle="#00ffff";
    ctx.beginPath();
    ctx.arc(s.x,s.y,s.size,0,Math.PI*2);
    ctx.fill();
  });
}

function updateEnemies(){
  enemies.forEach(e=>{
    const dx=player.x-e.x;
    const dy=player.y-e.y;
    const d=Math.hypot(dx,dy);
    e.x+=dx/d*e.speed;
    e.y+=dy/d*e.speed;
    if(d<40) life-=0.3;
  });
  document.getElementById("life").innerText=Math.floor(life);
}

function updateShots(){
  shots.forEach((s,i)=>{
    s.x+=s.dx;
    s.y+=s.dy;
    enemies.forEach((e,j)=>{
      if(Math.hypot(s.x-e.x,s.y-e.y)<30){
        enemies.splice(j,1);
        shots.splice(i,1);
        score+=10;
        document.getElementById("score").innerText=score;
      }
    });
  });
}

function rescue(){
  if(Math.hypot(player.x-princess.x,player.y-princess.y)<60){
    level++;
    newLevel();
  }
}

function loop(){
  update();
  draw();
  updateEnemies();
  updateShots();
  rescue();

  if(life<=0){
    document.getElementById("bgm").pause();
    document.getElementById("loseVoice").play();
    setTimeout(()=>location.reload(),2500);
  }
  requestAnimationFrame(loop);
}
</script>

</body>
</html>
