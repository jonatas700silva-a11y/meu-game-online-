<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>J√¥natas & √ârica</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  touch-action:none;
  user-select:none;
}

body{
  background:black;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  font-family:'Press Start 2P';
}

#container{
  width:360px;
  height:640px;
  background:black;
  border:4px solid #22c55e;
  position:relative;
}

canvas{
  width:100%;
  height:100%;
  background:#020617;
}

#hud{
  position:absolute;
  top:8px;
  left:8px;
  color:white;
  font-size:10px;
}

#controls{
  position:absolute;
  bottom:15px;
  width:100%;
  display:flex;
  justify-content:space-between;
  padding:0 10px;
}

#move{
  display:grid;
  grid-template-columns:50px 50px 50px;
  grid-template-rows:50px 50px 50px;
  gap:5px;
}

#actions{
  display:flex;
  flex-direction:column;
  gap:12px;
}

.btn{
  width:50px;
  height:50px;
  border-radius:50%;
  background:rgba(255,255,255,.15);
  color:white;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:18px;
}

#start{
  position:absolute;
  inset:0;
  background:black;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  color:#22c55e;
}

#start button{
  margin-top:20px;
  padding:10px 20px;
  background:#22c55e;
  border:none;
  font-family:'Press Start 2P';
}
</style>
</head>

<body>

<div id="container">

<div id="start">
  <div style="font-size:18px">J√îNATAS & √âRICA</div>
  <button onclick="startGame()">‚ñ∂ START</button>
</div>

<div id="hud">
‚ù§Ô∏è <span id="life">100</span><br>
üèÜ <span id="level">1</span><br>
‚≠ê <span id="score">0</span>
</div>

<canvas id="game" width="1080" height="1920"></canvas>

<div id="controls">

  <div id="move">
    <div></div>
    <div class="btn" ontouchstart="move.up=true" ontouchend="move.up=false">‚¨ÜÔ∏è</div>
    <div></div>

    <div class="btn" ontouchstart="move.left=true" ontouchend="move.left=false">‚¨ÖÔ∏è</div>
    <div></div>
    <div class="btn" ontouchstart="move.right=true" ontouchend="move.right=false">‚û°Ô∏è</div>

    <div></div>
    <div class="btn" ontouchstart="move.down=true" ontouchend="move.down=false">‚¨áÔ∏è</div>
    <div></div>
  </div>

  <div id="actions">
    <div class="btn" onclick="rotate()">üîÑ</div>
    <div class="btn" onclick="shoot()">‚ö°</div>
  </div>

</div>

</div>

<!-- Sons -->
<audio id="loseVoice">
  <source src="https://translate.google.com/translate_tts?ie=UTF-8&tl=pt-BR&client=tw-ob&q=Tente+novamente">
</audio>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let move={up:false,down:false,left:false,right:false};
let life=100,level=1,score=0,dir=1;

const player={x:540,y:960,size:40,speed:8};
let enemies=[],shots=[],princess={};

function startGame(){
  document.getElementById("start").style.display="none";
  newLevel();
  loop();
}

function rotate(){ dir*=-1; }

function shoot(){
  shots.push({
    x:player.x,
    y:player.y,
    dx:14*dir,
    dy:0,
    size:8
  });
}

function newLevel(){
  enemies=[];
  for(let i=0;i<level*4;i++){
    enemies.push({
      x:Math.random()*1080,
      y:Math.random()*1920,
      size:36,
      speed:2+level*0.2,
      life:30,
      points:10
    });
  }
  princess={x:Math.random()*1080,y:Math.random()*1920,size:20};
  document.getElementById("level").innerText=level;
}

function update(){
  if(move.up)player.y-=player.speed;
  if(move.down)player.y+=player.speed;
  if(move.left)player.x-=player.speed;
  if(move.right)player.x+=player.speed;

  player.x=Math.max(0,Math.min(1080-player.size,player.x));
  player.y=Math.max(0,Math.min(1920-player.size,player.y));
}

function draw(){
  ctx.fillStyle="#020617";
  ctx.fillRect(0,0,1080,1920);

  ctx.fillStyle="#22c55e";
  ctx.fillRect(player.x,player.y,player.size,player.size);

  enemies.forEach(e=>{
    ctx.fillStyle="#ef4444";
    ctx.fillRect(e.x,e.y,e.size,e.size);
  });

  ctx.fillStyle="hotpink";
  ctx.beginPath();
  ctx.arc(princess.x,princess.y,princess.size,0,Math.PI*2);
  ctx.fill();

  shots.forEach(s=>{
    ctx.fillStyle="#38bdf8";
    ctx.beginPath();
    ctx.arc(s.x,s.y,s.size,0,Math.PI*2);
    ctx.fill();
  });
}

function updateEnemies(){
  enemies.forEach(e=>{
    e.x+=(player.x-e.x)*0.01;
    e.y+=(player.y-e.y)*0.01;
    if(hit(player,e)){
      life-=0.4;
      document.getElementById("life").innerText=Math.floor(life);
    }
  });
}

function updateShots(){
  shots.forEach((s,i)=>{
    s.x+=s.dx;
    enemies.forEach((e,j)=>{
      if(dist(s,e)<30){
        enemies.splice(j,1);
        shots.splice(i,1);
        score+=e.points;
        document.getElementById("score").innerText=score;
      }
    });
  });
}

function rescue(){
  if(dist(player,princess)<50){
    alert("üíñ Voc√™ salvou √ârica!");
    level++;
    newLevel();
  }
}

function hit(a,b){
  return a.x<b.x+b.size&&a.x+a.size>b.x&&a.y<b.y+b.size&&a.y+a.size>b.y;
}

function dist(a,b){
  return Math.hypot(a.x-b.x,a.y-b.y);
}

function loop(){
  update();
  draw();
  updateEnemies();
  updateShots();
  rescue();

  if(life<=0){
    document.getElementById("loseVoice").play();
    setTimeout(()=>location.reload(),2000);
  }

  requestAnimationFrame(loop);
}
</script>

</body>
</html>
